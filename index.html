<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>ピーキング戦略（大会当日・完全版）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      padding: 20px;
      margin: 0;
    }
    .container {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 900px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      font-size: 1em;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
      word-break: break-word;
    }
    th {
      background-color: #eee;
    }
    .error {
      border: 2px solid red;
    }
    @media print {
      button { display: none; }
      body { -webkit-print-color-adjust: exact; }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ピーキング戦略（大会当日・完全版）</h1>

  <label>体重（kg）</label>
  <input id="weight" type="number" placeholder="例：70" />

  <label>体脂肪率（％）</label>
  <input id="bodyfat" type="number" placeholder="例：10" />

  <label>TDEE（1日の消費カロリー）</label>
  <input id="tdee" type="number" placeholder="例：2400" />

  <label>水分感受性</label>
  <select id="waterSensitivity">
    <option value="low">低（多め）</option>
    <option value="medium" selected>中</option>
    <option value="high">高（少なめ）</option>
  </select>

  <label>塩分感受性</label>
  <select id="saltSensitivity">
    <option value="low">低（多め）</option>
    <option value="medium" selected>中</option>
    <option value="high">高（少なめ）</option>
  </select>

  <button onclick="generateSchedule()">PFCと水分・塩分を計算</button>

  <div id="output"></div>
</div>

<script>
function generateSchedule() {
  const ids = ["weight", "bodyfat", "tdee"];
  let valid = true;
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (!el.value) {
      el.classList.add("error");
      valid = false;
    } else {
      el.classList.remove("error");
    }
  });
  if (!valid) {
    alert("体重・体脂肪率・TDEE を入力してください。");
    return;
  }

  const weight = parseFloat(document.getElementById("weight").value);
  const bodyfat = parseFloat(document.getElementById("bodyfat").value);
  const tdee = parseFloat(document.getElementById("tdee").value);
  const leanMass = weight * (1 - bodyfat / 100);
  const protein = Math.round(leanMass * 2.3);
  const fat = 30;
  const proteinKcal = protein * 4;
  const fatKcal = fat * 9;
  const carbKcal = tdee - proteinKcal - fatKcal;
  const carb = Math.round(carbKcal / 4);

  const waterBase = Math.max(weight * 0.05, 1.5);
  const saltBase = Math.max(weight * 0.1, 2);

  const waterSens = document.getElementById("waterSensitivity").value;
  const saltSens = document.getElementById("saltSensitivity").value;
  const adjust = (val, sens) => {
    const factor = { low: 1.2, medium: 1.0, high: 0.8 };
    return (val * factor[sens]).toFixed(1);
  };

  const water = adjust(waterBase, waterSens);
  const salt = Math.round(adjust(saltBase, saltSens));

  const output = document.getElementById("output");
  output.innerHTML = `
    <table>
      <thead>
        <tr><th>摂取カロリー</th><th>たんぱく質</th><th>脂質</th><th>炭水化物</th><th>水分</th><th>塩分</th><th>備考</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>${tdee} kcal</td>
          <td>${protein} g</td>
          <td>${fat} g</td>
          <td>${carb} g</td>
          <td>${water} L</td>
          <td>${salt} g</td>
          <td>パンプ直前はブドウ糖ラムネ・ゼリー飲料など吸収の早い糖が推奨</td>
        </tr>
      </tbody>
    </table>
  `;
}
</script>

</body>
</html>